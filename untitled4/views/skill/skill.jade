//
   Created by kmj on 2016-11-04.

extends skill_des
block scripts
    script(src = '/javascripts/cytoscape.js')
block cytoscape
    script.
        window.onload = function () {
            var cy = cytoscape({
                container: $('#left'),
                elements: [],
                style: [
                    {
                        selector: 'node',
                        style: {
                            shape: 'rectangle',
                            'text-valign': 'center',
                            'text-outline-width': 2,
                            'text-outline-color': 'data(faveColor)',
                            color: 'white',
                            'background-color': 'data(faveColor)',
                            label: 'data(name)',
                            width: '100',
                            height: '100',
                            'background-fit': 'cover'
                        }
                    }]
            });
            var list = '#{skillList}'.split(',');
            var usl = '#{usl}'.split(',');
            for(var i in list){
                if(usl.indexOf(list[i])>=0){
                    cy.add({
                        data: {id: list[i], name: list[i].replace(/\_/g, " "), faveColor: '#FF3333'},
                        position: {x: $('#cys').innerWidth()/6*5, y: $('#cys').innerHeight()/2}
                    });
                }else{
                    cy.add({
                        data: {id: list[i], name: list[i].replace(/\_/g, " "), faveColor:'#3366FF'},
                        position: {x: $('#cys').innerWidth()/6*5, y: $('#cys').innerHeight()/2}
                    });
                }
            }
            cy.layout({
                name: 'grid'
            });
            cy.on('tap', 'node', function () {
                try {
                    var select = this.data('id');
                    location.href = '/skill/subject/' + select;
                } catch (e) {
                    //error catch
                }
            });
            cy.on('mouseover', 'node', function () {
                try {
                    var content = this.data('name');
                    $('.document').html('<div id="result">'+ content+ '</div>');
                } catch (e) {
                    console.log(e);
                }
            });
        };